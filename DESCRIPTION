Package: scMappR
Title: Single Cell Mapper
Version: 0.1.4
Authors@R: 
    c(person(given = "Dustin", family = "Sokolowski", role = c("aut", "cre"), email = "dustin.sokolowski@sickkids.ca"), person(given = "Mariela", family = "Faykoo-Martinez", role = "aut", email = "mfaykoomartinez@gmail.com"), person(given = "Lauren", family = "Erdman", role = "aut", email = "lauren.erdman@sickkids.ca"), person(given = "Houyun", family = "Hou", role = "aut", email = "huayunhou@gmail.com"),  person(given = "Cadia", family = "Chan", role = "aut", email = "cadia.chan@mail.utoronto.ca"), person(given = "Helen", family = "Zhu", role = "aut", email = "helen.m.zhu@gmail.com"), person(given = "Melissa", family = "Holmes", role = "aut", email = "melissa.holmes@utoronto.ca"), person(given = "Anna", family = "Goldenberg", role = "aut", email = "nyulik@gmail.com"), person(given = "Michael", family = "Wilson", role = "aut", email = "michael.wilson@sickkids.ca"))
Description: *Description of scMappR R package adapted from pre-print*. The single cell mapper (scMappR) R package contains a suite of bioinformatic tools that provide experimentally relevant cell-type specific information to a list of differentially expressed genes (DEG). The primary function of scMappR is to integrate cell-type expression and cell-type proportions to calculate cell-weighted Fold-changes (cwFold-changes) and cell-type specific pathway analysis from inputted DEGs. cwFold-changes for all genes is ordered within a cell-type to estimate the rank-order of DEGs within each cell-type before a cell-type specific pathway analysis. The cwFold-change for each gene is ordered across cell-types to determine which cell-types were most likely responsible for the differential expression. Investigating cwFold-changes provides context to any differential analysis of a bulk tissue. scMappR ensures that the cell-type specific expression is relevant to the inputted gene list by containing a bioinformatic pipeline to process scRNA-seq data into a signature matrix, and pre-computed signature matrices of reprocessed scRNA-seq data for researchers to choose from. scMappR also provides cell-type specific gene set enrichment of scRNA-seq data for researchers without RNA-seq data and just a gene list. The function "scMappR_and_pathway_analysis" reranks DEGs to generate cell-type specificity scores called cell-weighted fold-changes. Users input a list of DEGs, normalized counts, and a signature matrix into this function. scMappR then re-weights bulk DEGs by cell-type specific expression from the signature matrix, cell-type proportions from RNA-seq deconvolution and the ratio of cell-type proportions between the two conditions to account for changes in cell-type proportion. RNA-seq deconvolution also relies on cell-type specific expression. Cell-type specific expression is used to estimate cell-type proportion, making cell-type expression and cell-type proportions dependent values. For each gene, scMappR makes cell-type specific expression and cell-type specific proportion independent values by iteratively removing each gene from the count matrix and the signature matrix before re-calculating cell-type proportions. With cell-type specificity scores computed, scMappR completes pathway analysis by reordering DEGs by their cwFold-changes. Genes that are differentially expressed in the same cell-types move closer in rank, which increases significance in gene set enrichment analysis. With cwFold-changes calculated, scMappR uses two approaches to utilize cwFold-changes to complete cell-type specific pathway analysis. Both approaches are completed by having scMappR rerank DEGs based on their cwFold-changes. Firstly, scMappR reranks DEGs by their cell-weighted fold-change for every cell-type before completing an ordered pathway enrichment. Here, genes are re-ordered by their cell-type specificity scores, but a highly differential ubiquitously expressed DEG may still have a very high rank. Pathway enrichment of the first approach represents biological pathways associated with the rank-change in expression of each cell-type. Secondly, scMappR reranks genes by their increase in cell-type specificity before completing an ordered pathway analysis. For example, if a gene is the 150th most differential DEG in bulk RNAseq and the second most differential cwFold-change for a cell-type, it would have a score of 148 for that cell-type. Pathway enrichment of the second approach represents biological pathways associated with genes most influenced by scMappR. The "process_dgTMatrix_lists" function in the scMappR package contains an automated scRNA-seq processing pipeline where users input scRNA-seq count data, which is made compatible for scMappR and other R packages that analyze scRNA-seq data (see Methods for details). We leveraged this pipeline to convert over 1,000 scRNA-seq count matrices processed by the PanglaoDB dataset into 245 signature matrices (that are regularly updating) in mouse and human. The functions "tissue_by_celltype_enrichment", "tissue_scMappR_internal", and "tissue_scMappR_custom" combine these consistently processed scRNAseq count data with gene-set enrichment tools to allow for cell-type marker enrichment of a generic gene list (e.g. GWAS hits). The "tissue_by_celltype_enrichment" function allows for gene set enrichment of all cell-type markers across all cell-types and tissues in scMappR. This gene-set database has the advantage of every cell-type marker originating from a completely consistent bioinformatic analysis. Alternatively, "tissue_scMappR_internal" and "tissue_scMappR_custom" provide a more hypothesis driven approach where researchers can ask if their list of genes are more likely to be expressed in one cell-type compared to other cell-types in the same tissue based on the over-representation of cell-type markers. Reference: Sokolowski,D.J., Faykoo-Martinez,M., Erdman,L., Hou,H., Chan,C., Zhu,H., Holmes,M.M., Goldenberg,A. and Wilson,M.D. (2020) Single-cell mapper (scMappR): using scRNA-seq to infer cell-type specificities of differentially expressed genes. BioRxiv, 10.1101/2020.08.24.265298.
Depends: R (>= 4.0.0)
Imports: 
	ggplot2, 
	pheatmap, 
	graphics, 
	Seurat, 
	GSVA, 
	stats, 
	utils,
	downloader,
	pcaMethods,
	grDevices,
	gProfileR,
	limSolve,
	gprofiler2,
	pbapply,
License: GPL-3
URL: 
Encoding: UTF-8
LazyData: true
RoxygenNote: 7.1.1
Packaged: 2020-02-13
Suggests: 
  testthat,
  knitr,
  rmarkdown
VignetteBuilder: knitr
